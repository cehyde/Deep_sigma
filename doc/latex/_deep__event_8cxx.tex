\hypertarget{_deep__event_8cxx}{}\doxysubsection{src/include/\+Deep\+\_\+event.cxx File Reference}
\label{_deep__event_8cxx}\index{src/include/Deep\_event.cxx@{src/include/Deep\_event.cxx}}


File generates a set of event four-\/vectors.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{_deep__event_8cxx_a59a1251df47ecad94e478812fa3df4d1}{Levi\+Civita4vec}} (TLorentz\+Vector vec1, TLorentz\+Vector vec2, TLorentz\+Vector vec3, double $\ast$vec4out)
\begin{DoxyCompactList}\small\item\em Construct a 4-\/vector contraction. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{_deep__event_8cxx_a33ddf7a38dcda05441673f3a5acc850b}{Levi\+Civita\+Scalar}} (TLorentz\+Vector vec4\+\_\+1, TLorentz\+Vector vec4\+\_\+2, TLorentz\+Vector vec4\+\_\+3, TLorentz\+Vector vec4\+\_\+4) int Event\+Light\+Cone()
\item 
int \mbox{\hyperlink{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}{Get\+\_\+\+Event}} (int i\+Evt)
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
File generates a set of event four-\/vectors. 

File contains event-\/by-\/event generation functions for $e p \to e\textnormal{\textquotesingle} p\textnormal{\textquotesingle} \pi \pi$.

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}\label{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}} 
\index{Deep\_event.cxx@{Deep\_event.cxx}!Get\_Event@{Get\_Event}}
\index{Get\_Event@{Get\_Event}!Deep\_event.cxx@{Deep\_event.cxx}}
\doxyparagraph{\texorpdfstring{Get\_Event()}{Get\_Event()}}
{\footnotesize\ttfamily int Get\+\_\+\+Event (\begin{DoxyParamCaption}\item[{int}]{i\+Evt }\end{DoxyParamCaption})}

\mbox{\hyperlink{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}{Get\+\_\+\+Event()}} generates ep-\/$>$e p pi pi events uniformly in phase space \[\left\{Q^2, y=q\cdot P/(k\cdot P), \phi_e, M_{\pi\pi}^2, \cos(\theta_{\pi\pi}^{CM}), \phi_{\pi\pi}^{CM}, \cos\theta_{\pi^+}^{Rest}, \phi_{\pi^+}^{Rest} \right\} \] Only basis 4-\/vectors e.\+g. $ n_q, \widetilde n_q, X_q, Y_q$ are boosted, all other variables are invariants.

After smearing the incident beam momenta, re-\/define the lepton-\/\+Ion light-\/cone vectors n4\+\_\+e, n4\+Tilde\+\_\+e, X4\+\_\+e, Y4\+\_\+e

Scattered lepton four-\/vector k4\+Scat = $k\textnormal{\textquotesingle}$.

\begin{align} \left[\begin{array}{r} Q^2 + 2 m_l^2 \\ 2(k\cdot P)(1-y) \end{array}\right] &= 2 \left[\begin{array}{rr} k\cdot \widetilde n_e,&\ k\cdot n_e \\ P\cdot \widetilde n_e,& P\cdot n_e \end{array}\right] \left[\begin{array}{r} k\textnormal{\textquotesingle} \cdot n_e \\ k\textnormal{\textquotesingle} \cdot \widetilde n_e \end{array}\right] \\ \left[\begin{array}{r} k\textnormal{\textquotesingle} \cdot n_e \\ k\textnormal{\textquotesingle} \cdot \widetilde n_e \end{array}\right] &= \frac{1}{(k\cdot \widetilde n_e)(P\cdot n_e) - (k\cdot n_e)(P\cdot \widetilde n_e)} \left[\begin{array}{rr} P\cdot n_e,&\ -k\cdot n_e \\ -P\cdot \widetilde n_e,& k\cdot \widetilde n_e \end{array}\right] \left[\begin{array}{r} Q^2/2 + m_l^2 \\ (k\cdot P)(1-y) \end{array}\right] \\ \mathbf k_\perp^{\prime 2} &= 2(k\textnormal{\textquotesingle}\cdot n_e)(k\textnormal{\textquotesingle}\cdot \widetilde n_e) - m_l^2 \end{align}

Define the lightcone vectors of q + P system \begin{align} n_q^\mu &= \frac{1}{\sqrt{2(1+\delta_Q)} } \left[ q^\mu \frac{M_{Ion}}{q\cdot P} + P^\mu \frac{\delta_Q}{M_{Ion}\left(1+\sqrt{1+\delta_Q}\right)} \right], \qquad \delta_Q = \frac{Q^2 M_\text{Ion}^2}{(q\cdot P)^2} \\ \widetilde n_q^\mu &= \frac{1}{\sqrt{2(1+\delta_Q)} } \left[ P^\mu \frac{\left(1+\sqrt{1+\delta_Q}\right)}{M_\text{Ion}} - q^\mu \frac{M_\text{Ion}}{q\cdot P} \right] \end{align}

Recoil proton kinematics\+:
\begin{DoxyItemize}
\item After boosting to the $q+P$ CM frame, $X_q^\mu,\, Y_q^\mu$ are pure space-\/like (vanishing time components) and the space parts of $n_q^\mu,\, \widetilde n_q^\mu$ are anti-\/colinear.
\item In this frame, the incident proton is collinear with the unit three vector
\item $ \mathbf v =\left.\left[ \widetilde n_q.Px(), \widetilde n_q.Py(), \widetilde n_q.Pz() \right]\right/ \widetilde n_q.E() $
\begin{DoxyItemize}
\item The recoil nucleon and the $\pi\pi$ system are back-\/to-\/back in $q+P$ CM frame.
\end{DoxyItemize}
\item Generate uniform distributions in
\begin{DoxyItemize}
\item cosine of polar-\/angle\+: $\cos\left(\theta_{\pi\pi}^{CM}\right) $; and
\item azimuthal-\/angle $\phi_{\pi\pi}^{CM}$
\end{DoxyItemize}
\item \[ \left[ \begin{array}{r} E\textnormal{\textquotesingle} \\ \left|\mathbf P^\prime\right| \\ \end{array} \right]^{CM} = \left[ \begin{array}{r} (W^2+M_\text{Ion}^2-M_{\pi\pi}^2) / (2\sqrt{W^2}) \\ \sqrt{\left[E^{\prime\text{CM}}\right]^2 - M_\text{Ion}^2} \end{array} \right] \] Construct CM unit 3-\/vector in incident ion direction \[ \mathbf v = \left[ \frac{\widetilde n_q.Px()}{\widetilde n_q.E()},\, \frac{\widetilde n_q.Py()}{\widetilde n_q.E()},\, \frac{\widetilde n_q.Pz()}{\widetilde n_q.E()}\right]^{CM} \] Define a longitudinal four-\/vector of the recoil proton in the CM frame\+: \[ \left[P_L^{\prime \mu}\right]^{CM} = \left[ E^{\prime}, -\left|\mathbf P\textnormal{\textquotesingle}\right| \cos\left(\theta_{\pi\pi}^\text{CM}\right) \mathbf v \right]^\text{CM} \] In any frame, the full recoil proton momentum four-\/vector is defined by\+: \[ P^{\prime\, \mu} = \left(P_L^{\prime\,CM}\cdot n_q^{CM} \right) \widetilde n_q^\mu + \left(P_L^{\prime\,CM}\cdot \widetilde n_q^{CM} \right) n_q^\mu - \left|\mathbf P\textnormal{\textquotesingle}\right|^\text{CM} \sin\theta_{\pi\pi}^{CM} \left[ \cos\phi_{\pi\pi}^{CM} X_q^\mu + \sin\phi_{\pi\pi}^{CM} Y_q^\mu \right] \] The momentum four-\/vector of the $\pi\pi$ system is simply \[P_{\pi\pi}^{\mu} = q^\mu + P^\mu - P^{\prime\,\mu} \]
\end{DoxyItemize}

Similar method to construct four vectors of the final state pions
\begin{DoxyItemize}
\item Generate the $ M_{\pi\pi} \rightarrow \pi \pi$ kinematics variables in the rest frame of the $ M_{\pi\pi}$ system.
\begin{DoxyItemize}
\item $ \cos\theta_\pi^\text{Rest}, \phi_\pi^\text{Rest} $ are generated uniformly
\item for charge pion, the $\pi^+ $ is the pion defined by $ \theta_\pi^\text{Rest} $
\item Is the phase space for a neutral pion $ 2\pi $ or $ 4\pi$ ?
\end{DoxyItemize}
\end{DoxyItemize}\mbox{\Hypertarget{_deep__event_8cxx_a59a1251df47ecad94e478812fa3df4d1}\label{_deep__event_8cxx_a59a1251df47ecad94e478812fa3df4d1}} 
\index{Deep\_event.cxx@{Deep\_event.cxx}!LeviCivita4vec@{LeviCivita4vec}}
\index{LeviCivita4vec@{LeviCivita4vec}!Deep\_event.cxx@{Deep\_event.cxx}}
\doxyparagraph{\texorpdfstring{LeviCivita4vec()}{LeviCivita4vec()}}
{\footnotesize\ttfamily int Levi\+Civita4vec (\begin{DoxyParamCaption}\item[{TLorentz\+Vector}]{vec1,  }\item[{TLorentz\+Vector}]{vec2,  }\item[{TLorentz\+Vector}]{vec3,  }\item[{double $\ast$}]{vec4out }\end{DoxyParamCaption})}



Construct a 4-\/vector contraction. 

\begin{align} {\tt vec4out}_{[0,1,2,3]} = {\tt vec4out}_\mu &= \epsilon_{\mu \nu \rho \sigma} {\tt vec1}^\nu {\tt vec2}^\rho {\tt vec3}^\sigma \nonumber \\ \epsilon_{0123} &= 1 \end{align} \mbox{\Hypertarget{_deep__event_8cxx_a33ddf7a38dcda05441673f3a5acc850b}\label{_deep__event_8cxx_a33ddf7a38dcda05441673f3a5acc850b}} 
\index{Deep\_event.cxx@{Deep\_event.cxx}!LeviCivitaScalar@{LeviCivitaScalar}}
\index{LeviCivitaScalar@{LeviCivitaScalar}!Deep\_event.cxx@{Deep\_event.cxx}}
\doxyparagraph{\texorpdfstring{LeviCivitaScalar()}{LeviCivitaScalar()}}
{\footnotesize\ttfamily double Levi\+Civita\+Scalar (\begin{DoxyParamCaption}\item[{TLorentz\+Vector}]{vec4\+\_\+1,  }\item[{TLorentz\+Vector}]{vec4\+\_\+2,  }\item[{TLorentz\+Vector}]{vec4\+\_\+3,  }\item[{TLorentz\+Vector}]{vec4\+\_\+4 }\end{DoxyParamCaption})}

Event\+Light\+Cone\+: Initialize lightcone vectors n4, n4\+Tilde \begin{align*} n4 &= ({\tt k4Beam} - \beta*{\tt P4Beam})/norm\\ {\tt n4Tilde}&= ({\tt P4Beam}+\beta\textnormal{\textquotesingle} *{\tt k4Beam})/norm2; \\ n4\cdot n4 &= 0 = n4Tilde\cdot n4Tilde \\ n4\cdot n4Tilde &= 1 \\ { k\_dot\_P} &= k4Beam.Dot(P4Beam); \\ {\tt sqrtDL} &= mLepton*MIon/{\tt (k_dot_P)}; \\ {\tt deltaL} &= sqrtDL*sqrtDL = \delta_L; \\ \end{align*}

Initialize lightcone vectors n4\+\_\+e, n4\+Tilde\+\_\+e, X4\+\_\+e, Y4\+\_\+e.

\begin{align} n_e^\mu &= \displaystyle \frac{\left[ k^\mu \left(1+\sqrt{1-\delta_l}\right) - \frac{m_l^2}{k\cdot P} P^\mu \right] }{\left[2 \sqrt{(k\cdot P)(1-\delta_l)} \right]} \nonumber \\ \qquad\qquad k^2 &= m_l^2, \qquad \delta_l = \left[\frac{m_l M_{\rm Ion}}{k\cdot P}\right]^2 \nonumber \\ \widetilde n_e^\mu &= \displaystyle \left[P^\mu - \frac{M_{\rm Ion}^2}{(k\cdot P)\left(1+\sqrt{1-\delta_l}\right)}k^\mu \right]\left/\frac{1}{\sqrt{(k\cdot P)(1-\delta_l)}} \right. \nonumber\\ n_e\cdot n_e &= 0 = \widetilde n_e\cdot \widetilde n_e \nonumber \nonumber\\ n_e\cdot \widetilde n_e &= 1 \\ \intertext{Transverse vectors} {\tt Y4Det} &= [0,0,1,0] = Y4_\text{Det}^\mu = \text{ ``up in Detector frame\textnormal{\textquotesingle}\textnormal{\textquotesingle}} \nonumber\\ [X4_{e0}]_\sigma &=\epsilon_{\mu\nu\rho\sigma}n4_e^\mu n4Tilde_e^\nu Y4_Det^\rho \nonumber \\ X4_e^\mu &= X4_{e0}^\mu/\sqrt{-X4_{e0}\cdot X4_{e0} } \nonumber\\ [Y4_e]_\sigma &= \epsilon_{\mu\nu\rho\sigma}n4_e^\mu X4_e^\nu n4Tilde_e^\rho\\ \end{align} If beam emmitance values in input file are positive, incident beam 4-\/vectors $k^\mu, P^\mu$ are generated with gaussian longitudinal and transverse emmittance relative to nominal input values $k_0^\mu, P_0^\mu$.

The transverse 4-\/vectors $ X_e^\mu,\, Y_e^\mu$ are defined assuming neither incident beam can ever be in the vertical direction.

Construct a the scaler anti-\/symmetric contraction of four space-\/time vectors \begin{align} *{\tt Scalar} &= \epsilon_{\mu \nu \rho \sigma} {\tt vec4_1}^\mu {\tt vec4_2}^\nu {\tt vec4_3}^\rho {\tt vec4_4}^\sigma\\ \epsilon_{0123} &= 1. \qquad\text{In TLorentzVector Notation}\quad\epsilon_{xyzt} = -\epsilon_{0123} = -1\\ \end{align} Note from TLorentz\+Vector documentation The components of TLorentz\+Vector can also accessed by index\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{xx = v(0);       or     xx = v[0];}
\DoxyCodeLine{yy = v(1);              yy = v[1];}
\DoxyCodeLine{zz = v(2);              zz = v[2];}
\DoxyCodeLine{tt = v(3);              tt = v[3];}

\end{DoxyCode}
