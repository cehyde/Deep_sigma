\hypertarget{_deep__event_8cxx}{}\doxysubsection{src/include/\+Deep\+\_\+event.cxx File Reference}
\label{_deep__event_8cxx}\index{src/include/Deep\_event.cxx@{src/include/Deep\_event.cxx}}


File generates a set of event four-\/vectors.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{_deep__event_8cxx_aaa42f141d71f794d63794a6d746aa375}{Levi\+Civita4vec}} (double vec1\mbox{[}4\mbox{]}, double vec2\mbox{[}4\mbox{]}, double vec3\mbox{[}4\mbox{]}, double $\ast$vec4out)
\begin{DoxyCompactList}\small\item\em Initialize lightcone vectors n4\+\_\+e, n4\+Tilde\+\_\+e, X4\+\_\+e, Y4\+\_\+e. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{_deep__event_8cxx_aef7afda743b97967e360e6b61ee44cb0}\label{_deep__event_8cxx_aef7afda743b97967e360e6b61ee44cb0}} 
int {\bfseries Event\+Light\+Cone} ()
\item 
int \mbox{\hyperlink{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}{Get\+\_\+\+Event}} (int i\+Evt)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}{Get\+\_\+\+Event()}} generates ep-\/$>$e p pi pi events uniformly in phase space. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
File generates a set of event four-\/vectors. 

File contains event-\/by-\/event generation functions for $e p \to e\textnormal{\textquotesingle} p\textnormal{\textquotesingle} \pi \pi$.

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}\label{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}} 
\index{Deep\_event.cxx@{Deep\_event.cxx}!Get\_Event@{Get\_Event}}
\index{Get\_Event@{Get\_Event}!Deep\_event.cxx@{Deep\_event.cxx}}
\doxyparagraph{\texorpdfstring{Get\_Event()}{Get\_Event()}}
{\footnotesize\ttfamily int Get\+\_\+\+Event (\begin{DoxyParamCaption}\item[{int}]{i\+Evt }\end{DoxyParamCaption})}



\mbox{\hyperlink{_deep__event_8cxx_a0cf25c5323c6cb149bd6bfb540131fc6}{Get\+\_\+\+Event()}} generates ep-\/$>$e p pi pi events uniformly in phase space. 

\[\left\{Q^2, y=q\cdot P/(k\cdot P), \phi_e, M_{\pi\pi}^2, \cos(\theta_{\pi\pi}^{CM}), \phi_{\pi\pi}^{CM}, \cos\theta_{\pi^+}^{Rest}, \phi_{\pi^+}^{Rest} \right\} \] Only basis 4-\/vectors e.\+g. $ n_q, \widetilde n_q, X_q, Y_q$ are boosted, all other variables are invariants. After smearing the incident beam momenta, re-\/define the lepton-\/\+Ion light-\/cone vectors n4\+\_\+e, n4\+Tilde\+\_\+e, X4\+\_\+e, Y4\+\_\+e

Scattered lepton four-\/vector k4\+Scat = $k\textnormal{\textquotesingle}$.

\begin{align} \left[\begin{array}{r} Q^2 + 2 m_l^2 \\ 2(k\cdot P)(1-y) \end{array}\right] &= 2 \left[\begin{array}{rr} k\cdot \widetilde n_e,&\ k\cdot n_e \\ P\cdot \widetilde n_e,& P\cdot n_e \end{array}\right] \left[\begin{array}{r} k\textnormal{\textquotesingle} \cdot n_e \\ k\textnormal{\textquotesingle} \cdot \widetilde n_e \end{array}\right] \\ \left[\begin{array}{r} k\textnormal{\textquotesingle} \cdot n_e \\ k\textnormal{\textquotesingle} \cdot \widetilde n_e \end{array}\right] &= \frac{1}{(k\cdot \widetilde n_e)(P\cdot n_e) - (k\cdot n_e)(P\cdot \widetilde n_e)} \left[\begin{array}{rr} P\cdot n_e,&\ -k\cdot n_e \\ -P\cdot \widetilde n_e,& k\cdot \widetilde n_e \end{array}\right] \left[\begin{array}{r} Q^2/2 + m_l^2 \\ (k\cdot P)(1-y) \end{array}\right] \\ \mathbf k_\perp^{\prime 2} &= 2(k\textnormal{\textquotesingle}\cdot n_e)(k\textnormal{\textquotesingle}\cdot \widetilde n_e) - m_l^2 \end{align}

Define the lightcone vectors of q + P system \begin{align} n_q^\mu &= \frac{1}{\sqrt{2(1+\delta_Q)} } \left[ q^\mu \frac{M_{Ion}}{q\cdot P} + P^\mu \frac{\delta_Q}{M_{Ion}\left(1+\sqrt{1+\delta_Q}\right)} \right], \qquad \delta_Q = \frac{Q^2 M_\text{Ion}^2}{(q\cdot P)^2} \\ \widetilde n_q^\mu &= \frac{1}{\sqrt{2(1+\delta_Q)} } \left[ P^\mu \frac{\left(1+\sqrt{1+\delta_Q}\right)}{M_\text{Ion}} - q^\mu \frac{M_\text{Ion}}{q\cdot P} \right] \end{align}

Recoil proton kinematics\+:
\begin{DoxyItemize}
\item After boosting to the $q+P$ CM frame, $X_q^\mu,\, Y_q^\mu$ are pure space-\/like (vanishing time components) and the space parts of $n_q^\mu,\, \widetilde n_q^\mu$ are anti-\/colinear.
\item In this frame, the incident proton is collinear with the unit three vector
\item $ \mathbf v =\left.\left[ \widetilde n_q.Px(), \widetilde n_q.Py(), \widetilde n_q.Pz() \right]\right/ \widetilde n_q.E() $
\begin{DoxyItemize}
\item The recoil nucleon and the $\pi\pi$ system are back-\/to-\/back in $q+P$ CM frame.
\end{DoxyItemize}
\item Generate uniform distributions in
\begin{DoxyItemize}
\item cosine of polar-\/angle\+: $\cos\left(\theta_{\pi\pi}^{CM}\right) $; and
\item azimuthal-\/angle $\phi_{\pi\pi}^{CM}$
\end{DoxyItemize}
\item \[ \left[ \begin{array}{r} E\textnormal{\textquotesingle} \\ \left|\mathbf P^\prime\right| \\ \end{array} \right]^{CM} = \left[ \begin{array}{r} (W^2+M_\text{Ion}^2-M_{\pi\pi}^2) / (2\sqrt{W^2}) \\ \sqrt{\left[E^{\prime\text{CM}}\right]^2 - M_\text{Ion}^2} \end{array} \right] \] Construct CM unit 3-\/vector in incident ion direction \[ \mathbf v = \left[ \frac{\widetilde n_q.Px()}{\widetilde n_q.E()},\, \frac{\widetilde n_q.Py()}{\widetilde n_q.E()},\, \frac{\widetilde n_q.Pz()}{\widetilde n_q.E()}\right]^{CM} \] Define a longitudinal four-\/vector of the recoil proton in the CM frame\+: \[ \left[P_L^{\prime \mu}\right]^{CM} = \left[ E^{\prime}, -\left|\mathbf P\textnormal{\textquotesingle}\right| \cos\left(\theta_{\pi\pi}^\text{CM}\right) \mathbf v \right]^\text{CM} \] In any frame, the full recoil proton momentum four-\/vector is defined by\+: \[ P^{\prime\, \mu} = \left(P_L^{\prime\,CM}\cdot n_q^{CM} \right) \widetilde n_q^\mu + \left(P_L^{\prime\,CM}\cdot \widetilde n_q^{CM} \right) n_q^\mu - \left|\mathbf P\textnormal{\textquotesingle}\right|^\text{CM} \sin\theta_{\pi\pi}^{CM} \left[ \cos\phi_{\pi\pi}^{CM} X_q^\mu + \sin\phi_{\pi\pi}^{CM} Y_q^\mu \right] \] The momentum four-\/vector of the $\pi\pi$ system is simply \[P_{\pi\pi}^{\mu} = q^\mu + P^\mu - P^{\prime\,\mu} \]
\end{DoxyItemize}

Similar method to construct four vectors of the final state pions
\begin{DoxyItemize}
\item Generate the $ M_{\pi\pi} \rightarrow \pi \pi$ kinematics variables in the rest frame of the $ M_{\pi\pi}$ system.
\begin{DoxyItemize}
\item $ \cos\theta_\pi^\text{Rest}, \phi_\pi^\text{Rest} $ are generated uniformly
\item for charge pion, the $\pi^+ $ is the pion defined by $ \theta_\pi^\text{Rest} $
\item Is the phase space for a neutral pion $ 2\pi $ or $ 4\pi$ ?
\end{DoxyItemize}
\end{DoxyItemize}\mbox{\Hypertarget{_deep__event_8cxx_aaa42f141d71f794d63794a6d746aa375}\label{_deep__event_8cxx_aaa42f141d71f794d63794a6d746aa375}} 
\index{Deep\_event.cxx@{Deep\_event.cxx}!LeviCivita4vec@{LeviCivita4vec}}
\index{LeviCivita4vec@{LeviCivita4vec}!Deep\_event.cxx@{Deep\_event.cxx}}
\doxyparagraph{\texorpdfstring{LeviCivita4vec()}{LeviCivita4vec()}}
{\footnotesize\ttfamily int Levi\+Civita4vec (\begin{DoxyParamCaption}\item[{double}]{vec1\mbox{[}4\mbox{]},  }\item[{double}]{vec2\mbox{[}4\mbox{]},  }\item[{double}]{vec3\mbox{[}4\mbox{]},  }\item[{double $\ast$}]{vec4out }\end{DoxyParamCaption})}



Initialize lightcone vectors n4\+\_\+e, n4\+Tilde\+\_\+e, X4\+\_\+e, Y4\+\_\+e. 

\begin{align} n_e^\mu &= \displaystyle \left[k^\mu\left(1+\sqrt{1-\delta_l}\right) - \frac{m_l^2}{k\cdot P} P^\mu \right] \left/\left[2 \sqrt{(k\cdot P)(1-\delta_l)} \right]\right., \qquad\qquad k^2 = m_l^2, \qquad \delta_l = \left[\frac{m_l M_{\rm Ion}}{k\cdot P}\right]^2 \\ \widetilde n_e^\mu &= \left[P^\mu - \frac{M_{\rm Ion}^2}{(k\cdot P)\left(1+\sqrt{1-\delta_l}\right)}k^\mu \right]\left/\frac{1}{\sqrt{(k\cdot P)(1-\delta_l)}} \right. \\ n_e\cdot n_e &= 0 = \widetilde n_e\cdot \widetilde n_e \\ n_e\cdot \widetilde n_e &= 1 \\ Transverse vectors \\ {\tt Y4Det}^\mu = [0,0,1,0] = up in Detector frame [X4_{e0}]_\sigma =\epsilon_{\mu\nu\rho\sigma}n4_e^\mu n4Tilde_e^\nu Y4_Det^\rho \\ X4_e^\mu = X4_{e0}^\mu/\sqrt{-X4_{e0}\cdot X4_{e0} } \\ [Y4_e]_\sigma = \epsilon_{\mu\nu\rho\sigma}n4_e^\mu X4_e^\nu n4Tilde_e^\rho\\ \end{align} If beam emmitance values in input file are positive, incident beam 4-\/vectors $k^\mu, P^\mu$ are generated with gaussian longitudinal and transverse emmittance relative to nominal input values $k_0^\mu, P_0^\mu$.

The transverse 4-\/vectors $ X_e^\mu,\, Y_e^\mu$ are defined assuming neither incident beam can ever be in the vertical direction. Construct a 4-\/vector contraction \begin{align} *{\tt vec4out}_\mu &= \epsilon_{\mu \nu \rho \sigma} {\tt vec1}^\nu {\tt vec2}^\rho {\tt vec3}^\sigma\\ \epsilon_{0123} &= 1\\ \end{align}